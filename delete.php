<?php
declare(strict_types=1);

/**
 * delete.php — Контроллер удаления книг.
 * * Особенность: Реализован паттерн "Soft Delete" (Мягкое удаление).
 * Мы не удаляем запись физически из таблицы (DELETE FROM), а лишь помечаем её как удаленную.
 * Это позволяет восстановить данные при ошибке и сохраняет целостность истории.
 */

require 'db.php';

// 1. Проверяем, передан ли ID и является ли он числом
// Приведение к (int) защищает от инъекций, превращая любой мусор в число (или 0)
$id = isset($_GET['id']) ? (int)$_GET['id'] : 0;

if ($id > 0) {
    // 2. Выполняем "Мягкое удаление"
    // Вместо DELETE FROM books... используем UPDATE
    $stmt = $pdo->prepare("UPDATE books SET is_deleted = 1 WHERE id = ?");
    $stmt->execute([$id]);
}

// 3. Возвращаем пользователя обратно в каталог
// Использование exit после header обязательно, чтобы остановить выполнение скрипта
header('Location: index.php');
exit;
?>